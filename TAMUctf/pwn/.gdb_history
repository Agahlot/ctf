disassemble main
break *0x0804861d
r
x/x $ebp-0xc
x/60wx 0xffffd31c-0x20
p/d 0x38333037
p/d 0x32303400
x/x 0xffffd308
p 0xffffd31c-0xffffd308
r
x/x $ebp-0xc
r $(python -c 'print "\x11\xba\x07\xf0"*20')
r < temp 
x/x $ebp-0xc
ni
c
r < temp 
x/60wx 0xffffd31c-0x20
r < temp 
x/60wx 0xffffd31c-0x20
x/x 0xffffd2fc+8
p 0xffffd31c-0xffffd304
p /d 0x18
r < temp 
p 0xffffd31c-0xffffd304
x/60wx 0xffffd31c-0x20
r < temp 
x/60wx 0xffffd31c-0x20
ni
c
q
i r
x/2i $eip
backtrace 
checksec 
q
ls
info registers 
pattern_create 
pattern_create 1024
r
i r
pattern_offset 0x46254130
pattern_create 243
r
r
r
shellcode 
shellcode generate linux x86
shellcode generate linux 
shellcode generate x86/linux exec
find "/bin/sh"
print system 
ropgadget 
ropsearch 
ropsearch "call esp" text
info proc mappings 
ropsearch "call esp" stack
ropsearch "call esp"
q
i r
x/2i $eip
q
i r
x/2i $eip
q
q
disassemble main
disassemble echo 
break *0x080485de
r < temp 
ni
q
break *0x080485de
r < temp 
ni
p system 
q
break *0x080485de
r < temp 
ni
c
q
r < temp 
q
i r
x/2i $eip
bt
disassemble 0xf7e03a10
x/2i 0xf7e03a10
p system 
disassemble system 
q
q
q
bt
q
p system 
find "/bin/sh"
q
p system 
q
x/s 0xf7f3eb8a
q
q
start 
p mprotect 
info proc mappings 
break *0x080485de
r < temp 
ni
c
info proc mappings 
vmmap 
p read
ropgadget 
r < temp 
ni
ni
finish 
r < temp 
ni
finish 
shellcode generate x86/linux exec
r < temp 
ni
c
q
start 
p exit 
r < temp 
break *0x080485de
r < temp 
ni
ni
ni
q
r < temp 
q
